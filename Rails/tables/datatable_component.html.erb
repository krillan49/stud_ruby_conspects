<div class='datatable p-3'>
  <% if content? %>
    <div class='filters'>
      <%= content %>
    </div>
  <% end %>
  <table <%= "data-editor-url=#{table.editor_url}" if table.editor_url.present? %> class="w-full">
    <thead>
      <tr>
        <% @meta.columns.each do |column| %>
          <th
            class='<%= column.classname(context) %>'
            <%= "data-controller=frame-link data-href=#{sorting_url(column, context)}" if column.sortable? %>>
            <div class='flex justify-between'>
              <span><%= column.caption(@meta.entity_name, @meta.path_for_i18n) %></span>
              <% if column.sortable? && @meta.sorting == true %>
                <span class='sorting'></span>
              <% end %>
            </div>
          </th>
        <% end %>
        <% if @meta.destroy %>
          <th></th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% @items.each do |item| %>
        <tr data-id='<%= item.to_signed_global_id if item.respond_to?(:to_signed_global_id) %>'>
          <% @meta.columns.each do |column| %>
            <% if column.editable? %>
              <td class='editable'
                data-controller='editable-cell'
                data-editable-cell-options-value='<%= column.editor.to_json %>'>
                <%= cell_value(item, column) %>
              </td>
            <% else %>
              <td><%= cell_value(item, column) %></td>
            <% end %>
          <% end %>
          <% if @meta.destroy %>
            <td>
              <%= link_to('Удалить', send(*@table.destroy_path(item)),
                        class: 'bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-2 rounded',
                        data: { turbo_frame: "_top",
                                turbo_method: :delete,
                                turbo_confirm: "Are you sure?" }) %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
  <%= paginate @items if @items.respond_to?(:total_pages) %>
</div>
